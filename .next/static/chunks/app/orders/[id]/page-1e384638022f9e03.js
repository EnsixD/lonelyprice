(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[12],{6525:function(e,t,s){Promise.resolve().then(s.bind(s,4408)),Promise.resolve().then(s.bind(s,7699)),Promise.resolve().then(s.bind(s,6161)),Promise.resolve().then(s.t.bind(s,2972,23))},4408:function(e,t,s){"use strict";s.d(t,{default:function(){return C}});var a=s(7437),r=s(2265),n=s(970),i=s(5186),l=s(2869),c=s(9378),o=s(3417),d=s(1817),u=s(2489),m=s(9322),h=s(9205);let x=(0,h.Z)("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),f=(0,h.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),p=(0,h.Z)("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),g=(0,h.Z)("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);var v=s(401);let j=(0,h.Z)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),b=(0,h.Z)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var y=s(5080),N=s(7276),w=s(3145),k=s(6110),z=s(781);function C(e){let{orderId:t,currentUser:s,orderStatus:h="pending",paymentStatus:C="unpaid"}=e,[_,Z]=(0,r.useState)(""),[S,I]=(0,r.useState)([]),[M,E]=(0,r.useState)(null),R=(0,r.useRef)(null),q=(0,r.useRef)(null),O=(0,r.useRef)(null),P=(0,r.useRef)(null),D=(0,r.useRef)(!0),A="cancelled"===h||"completed"===h;if(!t||!(null==s?void 0:s.id))return(0,a.jsxs)("div",{className:"flex flex-col h-full items-center justify-center p-6 text-center",children:[(0,a.jsx)(o.Z,{className:"w-12 h-12 text-muted-foreground/50 mb-3"}),(0,a.jsx)("div",{className:"text-muted-foreground mb-1",children:"Чат недоступен"}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground/70",children:"Нет данных для отображения"})]});let{messages:L,sendMessage:V,connectionStatus:F,isLoading:B,uploading:H}=function(e,t){let s=(0,n.e)(),[a,i]=(0,r.useState)([]),[l,c]=(0,r.useState)(!0),[o,d]=(0,r.useState)("connecting"),[u,m]=(0,r.useState)(!1),h=(0,r.useRef)(null),x=(0,r.useRef)(new Set),f=(0,r.useCallback)(async()=>{try{c(!0);let{data:t,error:a}=await s.from("messages").select("*").eq("order_id",e).order("created_at",{ascending:!0});if(a)throw a;let r=Array.from(new Set((null==t?void 0:t.map(e=>e.sender_id))||[])),n=[];if(r.length>0){let{data:e,error:t}=await s.from("profiles").select("id, full_name, avatar_url, is_admin").in("id",r);if(t)throw t;n=e||[]}let l=(null==t?void 0:t.map(e=>{let t=null==n?void 0:n.find(t=>t.id===e.sender_id),s=[];return e.attachments&&(Array.isArray(e.attachments)?s=e.attachments:"object"==typeof e.attachments&&(s=Object.values(e.attachments).filter(e=>"string"==typeof e))),{...e,profiles:t,attachments:s}}))||[];i(l)}catch(e){}finally{c(!1)}},[e,s]),p=(0,r.useCallback)(async t=>new Promise(async(a,r)=>{try{if(t.size>10485760)throw Error("Файл слишком большой. Максимум 10MB");let r=t.name.split(".").pop(),n="".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9),".").concat(r),i="chat/".concat(e,"/").concat(n),{error:l}=await s.storage.from("chat-attachments").upload(i,t,{cacheControl:"3600",upsert:!1});if(l)throw l;let{data:{publicUrl:c}}=s.storage.from("chat-attachments").getPublicUrl(i);a(c)}catch(e){r(e)}}),[e,s]),g=(0,r.useCallback)(async(a,r)=>{if(!(null==t?void 0:t.id))return null;let n=a&&a.trim().length>0,l=r&&r.length>0;if(!n&&!l)return null;m(!0);try{let c=[];if(l&&r){m(!0);let e=r.map(async e=>{try{return await p(e)}catch(e){throw e}});try{c=(await Promise.all(e)).filter(e=>e)}catch(e){if(!n)throw m(!1),e}}let o="temp-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),d=a.trim();!d&&c.length>0&&(d="\uD83D\uDCCE Файл(ы)");let u={id:o,order_id:e,sender_id:t.id,message:d,is_read:!1,created_at:new Date().toISOString(),attachments:c,profiles:{id:t.id,full_name:"Вы",is_admin:t.is_admin||!1}};i(e=>[...e,u]),x.current.add(o);let h={order_id:e,sender_id:t.id,message:d,is_read:!1};c.length>0&&(h.attachments=c);let{data:f,error:g}=await s.from("messages").insert(h).select().single();if(g)return i(e=>e.filter(e=>e.id!==o)),x.current.delete(o),m(!1),null;let{data:v}=await s.from("profiles").select("id, full_name, avatar_url, is_admin").eq("id",t.id).single(),j={...f,attachments:c,profiles:v||{id:t.id,full_name:"Вы",is_admin:t.is_admin||!1}};return i(e=>{let t=e.filter(e=>e.id!==o);return(x.current.delete(o),t.some(e=>e.id===j.id))?t:[...t,j]}),m(!1),j}catch(e){return m(!1),null}},[e,s,t,p]),v=(0,r.useCallback)(()=>{h.current&&s.removeChannel(h.current);let a=s.channel("order-".concat(e,"-messages")).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:"order_id=eq.".concat(e)},async e=>{if(x.current.has(e.new.id)||e.new.sender_id===(null==t?void 0:t.id))return;let{data:a}=await s.from("profiles").select("id, full_name, avatar_url, is_admin").eq("id",e.new.sender_id).single(),r=[];e.new.attachments&&(Array.isArray(e.new.attachments)?r=e.new.attachments:"object"==typeof e.new.attachments&&(r=Object.values(e.new.attachments).filter(e=>"string"==typeof e)));let n={...e.new,attachments:r,profiles:a};i(e=>e.some(e=>e.id===n.id)?e:[...e,n])}).subscribe(e=>{"SUBSCRIBED"===e?d("connected"):("CHANNEL_ERROR"===e||"CLOSED"===e)&&d("disconnected")});return h.current=a,()=>{h.current&&s.removeChannel(h.current),x.current.clear()}},[e,s,null==t?void 0:t.id]);return(0,r.useEffect)(()=>{f();let e=v();return()=>{e()}},[f,v]),{messages:a,loadMessages:f,sendMessage:g,uploadFile:p,connectionStatus:o,isLoading:l,uploading:u}}(t,s),T=(0,r.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"smooth";if(q.current&&D.current){let t=q.current.querySelector("[data-radix-scroll-area-viewport]");t&&t.scrollTo({top:t.scrollHeight,behavior:e})}},[]);(0,r.useEffect)(()=>{if(L.length>0){var e;let t=null===(e=q.current)||void 0===e?void 0:e.querySelector("[data-radix-scroll-area-viewport]");if(t){let e=t.scrollHeight-t.scrollTop-t.clientHeight<100;D.current=e,e&&T("auto")}}},[L.length,T]);let W=(0,r.useCallback)(()=>{var e;let t=null===(e=q.current)||void 0===e?void 0:e.querySelector("[data-radix-scroll-area-viewport]");if(t){let e=t.scrollHeight-t.scrollTop-t.clientHeight<100;D.current=e}},[]);(0,r.useEffect)(()=>{var e;let t=null===(e=q.current)||void 0===e?void 0:e.querySelector("[data-radix-scroll-area-viewport]");if(t)return t.addEventListener("scroll",W),()=>t.removeEventListener("scroll",W)},[W]);let G=e=>{I(t=>t.filter((t,s)=>s!==e))},Y=async e=>{if(e.preventDefault(),(_.trim()||0!==S.length)&&!A)try{await V(_,S)&&(Z(""),I([]),setTimeout(()=>{D.current=!0,T("smooth")},100))}catch(e){}};return B?(0,a.jsxs)("div",{className:"flex flex-col h-full items-center justify-center p-8",children:[(0,a.jsx)(d.Z,{className:"w-8 h-8 animate-spin text-primary mb-2"}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Загрузка сообщений..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k.Vq,{open:!!M,onOpenChange:()=>E(null),children:(0,a.jsx)(k.cZ,{className:"max-w-4xl max-h-[90vh] p-0 bg-transparent border-none",children:M&&(0,a.jsxs)("div",{className:"relative w-full h-full",children:[(0,a.jsx)(w.default,{src:M,alt:"Просмотр изображения",width:1200,height:800,className:"w-full h-auto max-h-[80vh] object-contain rounded-lg"}),(0,a.jsx)(k.GG,{className:"absolute top-4 right-4 bg-black/50 hover:bg-black/70 text-white p-2 rounded-full",children:(0,a.jsx)(u.Z,{className:"w-5 h-5"})})]})})}),(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsx)("div",{className:"border-b px-4 py-3 bg-muted/30",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"font-medium text-sm sm:text-base",children:["Чат по заказу #",t.slice(0,8)]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("connected"===F?"bg-green-500":"bg-red-500")}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"connected"===F?"Online":"Offline"})]})]})}),A&&(0,a.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border-b border-yellow-200 p-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-yellow-700 dark:text-yellow-300 text-xs sm:text-sm",children:[(0,a.jsx)(m.Z,{className:"w-4 h-4 flex-shrink-0"}),(0,a.jsxs)("span",{children:["Чат недоступен для"," ","cancelled"===h?"отмененных":"завершенных"," ","заказов"]})]})}),(0,a.jsx)("div",{ref:q,className:"flex-1 overflow-hidden",children:(0,a.jsx)(c.x,{className:"h-full p-3 sm:p-4",ref:q,children:(0,a.jsxs)("div",{ref:O,className:"space-y-3 sm:space-y-4 pb-4",children:[0===L.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full py-12 text-center",children:[(0,a.jsx)(o.Z,{className:"w-12 h-12 text-muted-foreground/50 mb-3"}),(0,a.jsx)("div",{className:"text-muted-foreground mb-1 text-sm sm:text-base",children:"Нет сообщений"}),(0,a.jsx)("div",{className:"text-xs sm:text-sm text-muted-foreground/70",children:"Начните общение первым"})]}):L.map(e=>{var t,r,n;let i=e.sender_id===s.id,c=e.id.startsWith("temp-"),o=i?"Вы":(null===(t=e.profiles)||void 0===t?void 0:t.full_name)||"Пользователь",u=o.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2);return(0,a.jsxs)("div",{className:"flex ".concat(i?"justify-end":"justify-start"," gap-2 sm:gap-3"),children:[!i&&(0,a.jsxs)(z.qE,{className:"w-8 h-8 sm:w-9 sm:h-9 flex-shrink-0",children:[(0,a.jsx)(z.F$,{src:null===(r=e.profiles)||void 0===r?void 0:r.avatar_url}),(0,a.jsx)(z.Q5,{className:"text-xs",children:u})]}),(0,a.jsxs)("div",{className:"max-w-[85%] ".concat(i?"text-right":""),children:[!i&&(0,a.jsx)("div",{className:"text-xs text-muted-foreground mb-1 ml-1",children:o}),(0,a.jsxs)("div",{className:"px-3 sm:px-4 py-2 sm:py-3 rounded-xl text-sm ".concat(c?"bg-muted opacity-70":i?"bg-primary text-primary-foreground":"bg-muted"," ").concat(i?"rounded-br-none":"rounded-bl-none"),children:[e.message&&(0,a.jsx)("div",{className:"break-words whitespace-pre-wrap mb-2",children:e.message}),e.attachments&&e.attachments.length>0&&(0,a.jsx)("div",{className:"mt-2 space-y-2",children:e.attachments.map((e,t)=>{let s=e.match(/\.(jpg|jpeg|png|gif|webp|bmp)$/i);return(0,a.jsx)("div",{className:"relative group",children:s?(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"w-32 h-32 sm:w-48 sm:h-48 rounded-lg overflow-hidden border cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>E(e),children:(0,a.jsx)(w.default,{src:e,alt:"Прикрепленное фото",width:192,height:192,className:"w-full h-full object-cover",unoptimized:!0})}),(0,a.jsx)(l.z,{size:"icon",variant:"ghost",className:"absolute top-1 sm:top-2 right-1 sm:right-2 h-6 w-6 sm:h-7 sm:w-7 bg-black/50 hover:bg-black/70 text-white opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>E(e),children:(0,a.jsx)(x,{className:"w-3 h-3"})}),(0,a.jsx)(l.z,{size:"icon",variant:"ghost",className:"absolute bottom-1 sm:bottom-2 right-1 sm:right-2 h-6 w-6 sm:h-7 sm:w-7 bg-black/50 hover:bg-black/70 text-white opacity-0 group-hover:opacity-100 transition-opacity",onClick:t=>{t.preventDefault(),window.open(e,"_blank")},children:(0,a.jsx)(f,{className:"w-3 h-3"})})]}):(0,a.jsxs)("div",{className:"flex items-center gap-2 p-2 sm:p-3 bg-gray-100 dark:bg-gray-800 rounded-lg",children:[(0,a.jsx)(p,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsx)("p",{className:"text-xs sm:text-sm truncate",children:e.split("/").pop()||"Файл ".concat(t+1)})}),(0,a.jsx)(l.z,{size:"icon",variant:"ghost",onClick:()=>window.open(e,"_blank"),className:"h-7 w-7 sm:h-8 sm:w-8",children:(0,a.jsx)(f,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]})},t)})}),(0,a.jsxs)("div",{className:"mt-2 text-xs flex items-center gap-1 opacity-80 ".concat(i?"justify-end":"justify-start"),children:[!c&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:(0,y.Q)(new Date(e.created_at),{addSuffix:!0,locale:N.ru})}),i&&(0,a.jsx)("span",{className:"ml-1",children:e.is_read?(0,a.jsx)(g,{className:"w-3 h-3 inline"}):(0,a.jsx)(v.Z,{className:"w-3 h-3 inline"})})]}),c&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.Z,{className:"w-3 h-3 animate-spin"}),(0,a.jsx)("span",{children:"Отправка..."})]})]})]})]}),i&&(0,a.jsxs)(z.qE,{className:"w-8 h-8 sm:w-9 sm:h-9 flex-shrink-0",children:[(0,a.jsx)(z.F$,{src:null===(n=s.user_metadata)||void 0===n?void 0:n.avatar_url}),(0,a.jsx)(z.Q5,{className:"text-xs",children:u})]})]},e.id)}),(0,a.jsx)("div",{ref:P})]})})}),S.length>0&&(0,a.jsxs)("div",{className:"border-t border-b p-3 bg-gray-50 dark:bg-gray-900",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:"Прикрепленные файлы:"}),(0,a.jsxs)(l.z,{variant:"ghost",size:"sm",onClick:()=>I([]),className:"h-7 text-xs",children:[(0,a.jsx)(u.Z,{className:"w-3 h-3 mr-1"}),"Очистить"]})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:S.map((e,t)=>{let s=e.type.startsWith("image/");return(0,a.jsxs)("div",{className:"flex items-center gap-2 px-2 sm:px-3 py-1 sm:py-2 bg-white dark:bg-gray-800 rounded-lg border text-xs sm:text-sm",children:[s?(0,a.jsx)(j,{className:"w-3 h-3 sm:w-4 sm:h-4"}):(0,a.jsx)(p,{className:"w-3 h-3 sm:w-4 sm:h-4"}),(0,a.jsx)("span",{className:"truncate max-w-[100px] sm:max-w-[150px]",children:e.name}),(0,a.jsxs)("span",{className:"text-xs text-gray-500 hidden sm:inline",children:[(e.size/1024).toFixed(1)," KB"]}),(0,a.jsx)(l.z,{variant:"ghost",size:"icon",onClick:()=>G(t),className:"h-5 w-5 sm:h-6 sm:w-6",children:(0,a.jsx)(u.Z,{className:"w-2 h-2 sm:w-3 sm:h-3"})})]},t)})})]}),(0,a.jsxs)("form",{onSubmit:Y,className:"border-t p-3 bg-background",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"file",ref:R,onChange:e=>{if(e.target.files){let t=Array.from(e.target.files).filter(e=>e.size<=10485760).slice(0,5);I(e=>[...e,...t]),e.target.value=""}},multiple:!0,accept:"image/*,.pdf,.doc,.docx,.txt",className:"hidden"}),(0,a.jsx)(l.z,{type:"button",variant:"outline",size:"icon",onClick:()=>{var e;return null===(e=R.current)||void 0===e?void 0:e.click()},disabled:A,title:"Прикрепить файл",className:"h-10 w-10 flex-shrink-0",children:(0,a.jsx)(p,{className:"w-4 h-4"})}),(0,a.jsx)(i.I,{value:_,onChange:e=>Z(e.target.value),placeholder:A?"Чат недоступен":"Введите сообщение...",disabled:A,className:"flex-1 text-sm sm:text-base"}),(0,a.jsx)(l.z,{type:"submit",disabled:!_.trim()&&0===S.length||A||H,size:"icon",className:"h-10 w-10 flex-shrink-0",children:H?(0,a.jsx)(d.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(b,{className:"w-4 h-4"})})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-2 flex justify-between",children:[(0,a.jsx)("span",{className:"hidden sm:inline",children:"Макс. 5 файлов, 10MB каждый"}),(0,a.jsx)("span",{className:"sm:hidden",children:"Макс. 5 файлов"}),"disconnected"===F&&(0,a.jsx)("span",{className:"text-red-500 text-xs",children:"Нет соединения"})]})]})]})]})}},7699:function(e,t,s){"use strict";s.d(t,{MobileNav:function(){return z}});var a=s(7437),r=s(2265),n=s(7648),i=s(2869),l=s(185),c=s(2489),o=s(4508);function d(e){let{...t}=e;return(0,a.jsx)(l.fC,{"data-slot":"sheet",...t})}function u(e){let{...t}=e;return(0,a.jsx)(l.xz,{"data-slot":"sheet-trigger",...t})}function m(e){let{...t}=e;return(0,a.jsx)(l.h_,{"data-slot":"sheet-portal",...t})}function h(e){let{className:t,...s}=e;return(0,a.jsx)(l.aV,{"data-slot":"sheet-overlay",className:(0,o.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function x(e){let{className:t,children:s,side:r="right",...n}=e;return(0,a.jsxs)(m,{children:[(0,a.jsx)(h,{}),(0,a.jsxs)(l.VY,{"data-slot":"sheet-content",className:(0,o.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500","right"===r&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm","left"===r&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm","top"===r&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b","bottom"===r&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",t),...n,children:[s,(0,a.jsxs)(l.x8,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[(0,a.jsx)(c.Z,{className:"size-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function f(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"sheet-header",className:(0,o.cn)("flex flex-col gap-1.5 p-4",t),...s})}function p(e){let{className:t,...s}=e;return(0,a.jsx)(l.Dx,{"data-slot":"sheet-title",className:(0,o.cn)("text-foreground font-semibold",t),...s})}var g=s(3566),v=s(1239),j=s(4938),b=s(6275),y=s(8736),N=s(2369),w=s(9090),k=s(7806);function z(e){let{user:t,cartCount:s}=e,[l,c]=(0,r.useState)(!1);return(0,a.jsxs)(d,{open:l,onOpenChange:c,children:[(0,a.jsx)(u,{asChild:!0,children:(0,a.jsxs)(i.z,{variant:"ghost",size:"sm",className:"md:hidden cursor-pointer",children:[(0,a.jsx)(g.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"sr-only",children:"Открыть меню"})]})}),(0,a.jsxs)(x,{side:"left",className:"w-[280px] sm:w-[350px]",modal:!0,children:[(0,a.jsx)(f,{children:(0,a.jsxs)(p,{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center",children:(0,a.jsx)(v.Z,{className:"w-5 h-5 text-primary"})}),"Lonely PRICE"]})}),(0,a.jsxs)("nav",{className:"flex flex-col gap-3 mt-8",children:[(0,a.jsx)(i.z,{asChild:!0,variant:"ghost",className:"justify-start cursor-pointer",onClick:()=>c(!1),children:(0,a.jsxs)(n.default,{href:"/",children:[(0,a.jsx)(j.Z,{className:"w-5 h-5 mr-3"}),"Главная"]})}),(0,a.jsx)(i.z,{asChild:!0,variant:"ghost",className:"justify-start cursor-pointer",onClick:()=>c(!1),children:(0,a.jsxs)(n.default,{href:"/services",children:[(0,a.jsx)(b.Z,{className:"w-5 h-5 mr-3"}),"Каталог услуг"]})}),(0,a.jsx)(i.z,{asChild:!0,variant:"ghost",className:"justify-start cursor-pointer",onClick:()=>c(!1),children:(0,a.jsxs)(n.default,{href:"/terms",children:[(0,a.jsx)(y.Z,{className:"w-5 h-5 mr-3"}),"Условия и соглашения"]})}),t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.z,{asChild:!0,variant:"ghost",className:"justify-start cursor-pointer",onClick:()=>c(!1),children:(0,a.jsxs)(n.default,{href:"/dashboard/cart",children:[(0,a.jsx)(b.Z,{className:"w-5 h-5 mr-3"}),"Корзина ",s?"(".concat(s,")"):""]})}),(0,a.jsx)(i.z,{asChild:!0,variant:"ghost",className:"justify-start cursor-pointer",onClick:()=>c(!1),children:(0,a.jsxs)(n.default,{href:"/dashboard/profile",children:[(0,a.jsx)(N.Z,{className:"w-5 h-5 mr-3"}),"Мой профиль"]})})]}),!t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.z,{asChild:!0,variant:"ghost",className:"justify-start cursor-pointer",onClick:()=>c(!1),children:(0,a.jsxs)(n.default,{href:"/auth/login",children:[(0,a.jsx)(w.Z,{className:"w-5 h-5 mr-3"}),"Войти"]})}),(0,a.jsx)(i.z,{asChild:!0,className:"justify-start cursor-pointer",onClick:()=>c(!1),children:(0,a.jsxs)(n.default,{href:"/auth/register",children:[(0,a.jsx)(k.Z,{className:"w-5 h-5 mr-3"}),"Регистрация"]})})]})]})]})]})}},6161:function(e,t,s){"use strict";s.d(t,{PaymentDetails:function(){return p}});var a=s(7437),r=s(2265),n=s(2869),i=s(6070),l=s(9205);let c=(0,l.Z)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);var o=s(8226);let d=(0,l.Z)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);var u=s(401);let m=(0,l.Z)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var h=s(9322),x=s(4438);let f=[{id:"phone",name:"По номеру телефона",icon:(0,a.jsx)(c,{className:"w-5 h-5"}),details:"+79527985736",description:"Перевод на номер телефона (ВТБ)"},{id:"card",name:"По номеру карты",icon:(0,a.jsx)(o.Z,{className:"w-5 h-5"}),details:"2200 7000 1234 5678",description:"Карта ВТБ (Юлия А.)"},{id:"bank",name:"Банковский перевод",icon:(0,a.jsx)(d,{className:"w-5 h-5"}),details:"ВТБ (ПАО)",description:"БИК 044525187, к/с 30101810700000000187"}];function p(e){let{orderId:t,amount:s}=e,[l,c]=(0,r.useState)(null),d=(e,t)=>{navigator.clipboard.writeText(e),c(t),x.A.success("Скопировано в буфер обмена"),setTimeout(()=>c(null),2e3)};return(0,a.jsxs)(i.Zb,{className:"border shadow-sm hover:shadow-md transition-shadow",children:[(0,a.jsx)(i.Ol,{className:"pb-3",children:(0,a.jsxs)(i.ll,{className:"flex items-center gap-2 text-lg",children:[(0,a.jsx)(o.Z,{className:"w-5 h-5 text-primary"}),"Реквизиты для оплаты"]})}),(0,a.jsxs)(i.aY,{className:"space-y-6",children:[(0,a.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Сумма к оплате"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-primary",children:[s.toLocaleString("ru-RU")," ₽"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Номер заказа"}),(0,a.jsxs)("p",{className:"text-lg font-mono",children:["#",t.slice(0,8)]})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Комментарий к платежу"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsxs)("p",{className:"text-sm font-medium bg-gray-100 dark:bg-gray-700 px-3 py-2 rounded flex-1",children:["Заказ #",t.slice(0,8)," Lonely PRICE"]}),(0,a.jsx)(n.z,{size:"icon",variant:"ghost",onClick:()=>d("Заказ #".concat(t.slice(0,8)," Lonely PRICE"),"comment"),className:"h-10 w-10",children:"comment"===l?(0,a.jsx)(u.Z,{className:"w-4 h-4 text-green-500"}):(0,a.jsx)(m,{className:"w-4 h-4"})})]})]})]})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Выберите удобный способ оплаты:"}),f.map(e=>(0,a.jsxs)("div",{className:"border rounded-lg p-4 hover:border-primary/50 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg bg-primary/10 text-primary",children:e.icon}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:e.description})]})]}),(0,a.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>d(e.details,e.id),className:"h-9 w-9",children:l===e.id?(0,a.jsx)(u.Z,{className:"w-4 h-4 text-green-500"}):(0,a.jsx)(m,{className:"w-4 h-4"})})]}),(0,a.jsx)("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-800 rounded",children:(0,a.jsx)("p",{className:"font-mono text-lg text-center",children:e.details})})]},e.id))]}),(0,a.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)(h.Z,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),(0,a.jsxs)("div",{className:"text-sm text-blue-700 dark:text-blue-300",children:[(0,a.jsx)("p",{className:"font-medium",children:"Инструкция по оплате:"}),(0,a.jsxs)("ol",{className:"list-decimal ml-4 mt-1 space-y-1",children:[(0,a.jsx)("li",{children:"Скопируйте реквизиты удобным способом"}),(0,a.jsxs)("li",{children:["Переведите сумму ",s.toLocaleString("ru-RU")," ₽"]}),(0,a.jsxs)("li",{children:["В комментарии укажите:"," ",(0,a.jsxs)("strong",{children:["Заказ #",t.slice(0,8)]})]}),(0,a.jsx)("li",{children:"Отправьте фото чека в чат для подтверждения"})]})]})]})})]})]})}},781:function(e,t,s){"use strict";s.d(t,{qE:function(){return b},Q5:function(){return N},F$:function(){return y}});var a=s(7437),r=s(2265),n=s(3966),i=s(6606),l=s(1188),c=s(6840),o="Avatar",[d,u]=(0,n.b)(o),[m,h]=d(o),x=r.forwardRef((e,t)=>{let{__scopeAvatar:s,...n}=e,[i,l]=r.useState("idle");return(0,a.jsx)(m,{scope:s,imageLoadingStatus:i,onImageLoadingStatusChange:l,children:(0,a.jsx)(c.WV.span,{...n,ref:t})})});x.displayName=o;var f="AvatarImage",p=r.forwardRef((e,t)=>{let{__scopeAvatar:s,src:n,onLoadingStatusChange:o=()=>{},...d}=e,u=h(f,s),m=function(e,t){let[s,a]=r.useState("idle");return(0,l.b)(()=>{if(!e){a("error");return}let s=!0,r=new window.Image,n=e=>()=>{s&&a(e)};return a("loading"),r.onload=n("loaded"),r.onerror=n("error"),r.src=e,t&&(r.referrerPolicy=t),()=>{s=!1}},[e,t]),s}(n,d.referrerPolicy),x=(0,i.W)(e=>{o(e),u.onImageLoadingStatusChange(e)});return(0,l.b)(()=>{"idle"!==m&&x(m)},[m,x]),"loaded"===m?(0,a.jsx)(c.WV.img,{...d,ref:t,src:n}):null});p.displayName=f;var g="AvatarFallback",v=r.forwardRef((e,t)=>{let{__scopeAvatar:s,delayMs:n,...i}=e,l=h(g,s),[o,d]=r.useState(void 0===n);return r.useEffect(()=>{if(void 0!==n){let e=window.setTimeout(()=>d(!0),n);return()=>window.clearTimeout(e)}},[n]),o&&"loaded"!==l.imageLoadingStatus?(0,a.jsx)(c.WV.span,{...i,ref:t}):null});v.displayName=g;var j=s(4508);function b(e){let{className:t,...s}=e;return(0,a.jsx)(x,{"data-slot":"avatar",className:(0,j.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",t),...s})}function y(e){let{className:t,...s}=e;return(0,a.jsx)(p,{"data-slot":"avatar-image",className:(0,j.cn)("aspect-square size-full",t),...s})}function N(e){let{className:t,...s}=e;return(0,a.jsx)(v,{"data-slot":"avatar-fallback",className:(0,j.cn)("bg-muted flex size-full items-center justify-center rounded-full",t),...s})}},2869:function(e,t,s){"use strict";s.d(t,{d:function(){return l},z:function(){return c}});var a=s(7437);s(2265);var r=s(7053),n=s(535),i=s(4508);let l=(0,n.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function c(e){let{className:t,variant:s,size:n,asChild:c=!1,...o}=e,d=c?r.g7:"button";return(0,a.jsx)(d,{"data-slot":"button",className:(0,i.cn)(l({variant:s,size:n,className:t})),...o})}},6070:function(e,t,s){"use strict";s.d(t,{Ol:function(){return i},SZ:function(){return c},Zb:function(){return n},aY:function(){return o},eW:function(){return d},ll:function(){return l}});var a=s(7437);s(2265);var r=s(4508);function n(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}function i(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...s})}function l(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",t),...s})}function c(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",t),...s})}function o(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",t),...s})}function d(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-footer",className:(0,r.cn)("flex items-center px-6 [.border-t]:pt-6",t),...s})}},6110:function(e,t,s){"use strict";s.d(t,{$N:function(){return f},Be:function(){return p},GG:function(){return d},Vq:function(){return l},cN:function(){return x},cZ:function(){return m},fK:function(){return h},hg:function(){return c}});var a=s(7437);s(2265);var r=s(185),n=s(2489),i=s(4508);function l(e){let{...t}=e;return(0,a.jsx)(r.fC,{"data-slot":"dialog",...t})}function c(e){let{...t}=e;return(0,a.jsx)(r.xz,{"data-slot":"dialog-trigger",...t})}function o(e){let{...t}=e;return(0,a.jsx)(r.h_,{"data-slot":"dialog-portal",...t})}function d(e){let{...t}=e;return(0,a.jsx)(r.x8,{"data-slot":"dialog-close",...t})}function u(e){let{className:t,...s}=e;return(0,a.jsx)(r.aV,{"data-slot":"dialog-overlay",className:(0,i.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function m(e){let{className:t,children:s,showCloseButton:l=!0,...c}=e;return(0,a.jsxs)(o,{"data-slot":"dialog-portal",children:[(0,a.jsx)(u,{}),(0,a.jsxs)(r.VY,{"data-slot":"dialog-content",className:(0,i.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...c,children:[s,l&&(0,a.jsxs)(r.x8,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(n.Z,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function h(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-header",className:(0,i.cn)("flex flex-col gap-2 text-center sm:text-left",t),...s})}function x(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-footer",className:(0,i.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...s})}function f(e){let{className:t,...s}=e;return(0,a.jsx)(r.Dx,{"data-slot":"dialog-title",className:(0,i.cn)("text-lg leading-none font-semibold",t),...s})}function p(e){let{className:t,...s}=e;return(0,a.jsx)(r.dk,{"data-slot":"dialog-description",className:(0,i.cn)("text-muted-foreground text-sm",t),...s})}},5186:function(e,t,s){"use strict";s.d(t,{I:function(){return n}});var a=s(7437);s(2265);var r=s(4508);function n(e){let{className:t,type:s,...n}=e;return(0,a.jsx)("input",{type:s,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...n})}},9378:function(e,t,s){"use strict";s.d(t,{x:function(){return i}});var a=s(7437);s(2265);var r=s(6255),n=s(4508);function i(e){let{className:t,children:s,...i}=e;return(0,a.jsxs)(r.fC,{"data-slot":"scroll-area",className:(0,n.cn)("relative",t),...i,children:[(0,a.jsx)(r.l_,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:s}),(0,a.jsx)(l,{}),(0,a.jsx)(r.Ns,{})]})}function l(e){let{className:t,orientation:s="vertical",...i}=e;return(0,a.jsx)(r.gb,{"data-slot":"scroll-area-scrollbar",orientation:s,className:(0,n.cn)("flex touch-none p-px transition-colors select-none","vertical"===s&&"h-full w-2.5 border-l border-l-transparent","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent",t),...i,children:(0,a.jsx)(r.q4,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}},970:function(e,t,s){"use strict";let a;s.d(t,{e:function(){return n}});var r=s(1695);function n(){if(a)return a;let e="https://lvjmvxhppvssyhryjaal.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx2am12eGhwcHZzc3locnlqYWFsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU3MDE2MzQsImV4cCI6MjA4MTI3NzYzNH0.xpHw8-n5DI1w0EZQz415rMn_Ejdr2GWxMzaz7ySIvB0";if(!e||!t)throw Error("Missing Supabase environment variables");return a=(0,r.createBrowserClient)(e,t)}},4508:function(e,t,s){"use strict";s.d(t,{cn:function(){return n}});var a=s(1994),r=s(3335);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}},9322:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},3145:function(e,t,s){"use strict";s.d(t,{default:function(){return r.a}});var a=s(8461),r=s.n(a)},8461:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{default:function(){return c},getImageProps:function(){return l}});let a=s(7043),r=s(5346),n=s(5878),i=a._(s(5084));function l(e){let{props:t}=(0,r.getImgProps)(e,{defaultLoader:i.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,s]of Object.entries(t))void 0===s&&delete t[e];return{props:t}}let c=n.Image}},function(e){e.O(0,[137,972,172,122,559,361,695,438,975,95,971,117,744],function(){return e(e.s=6525)}),_N_E=e.O()}]);